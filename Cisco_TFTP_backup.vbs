#$language = "VBScript"
#$interface = "1.0"

crt.Screen.Synchronous = True

' This script automatically backup running configuration to a tftp server
' Use : After login to a cisco device with the SecureCRT go to Script > Run
' Author Md Shifat Uddin Created on 05-Jun-2024
' Version 1.0


Sub Main
	Dim get_hostname
	Dim ftp_server
	ftp_server = "10.100.100.67"
	crt.Screen.Send chr(13)
	crt.Screen.WaitForString "#"
	crt.Screen.Send "sh run | inc hostname" & chr(13)
	crt.Screen.WaitForString chr(13)
	get_hostname = crt.Screen.ReadString(chr(13))
	name = Split(get_hostname)
	filename = name(1) &"-config-"& Month(Date)&"-"& Day(Date)&"-"& Year(Date)
	crt.Screen.Send chr(13)
	crt.Screen.WaitForString "#"
	crt.Screen.Send "copy running-config tftp://"&ftp_server&"/"& filename & chr(13)
	crt.Screen.Send chr(13)
	crt.Screen.Send chr(13)
	crt.Screen.WaitForString "copied"
	crt.Dialog.MessageBox("configuration saved on "& ftp_server &" as "&filename)

End Sub
